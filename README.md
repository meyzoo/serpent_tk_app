# README.md

## Serpent (CTR) — GUI-приложение на Tkinter (Python 3.9.12)

Данное приложение реализует шифрование и расшифрование текстовых данных с использованием блочного шифра **Serpent** и режима работы **CTR**.  
Интерфейс выполнен на **tkinter/ttk** и поддерживает работу с многострочным текстом, генерацию ключей, а также загрузку/сохранение данных в текстовые файлы.

---

## 1. Возможности

- Шифрование текста (UTF-8) алгоритмом **Serpent-CTR**
- Расшифрование из контейнера шифртекста
- **Генерация ключа** (128/192/256 бит)
- **Загрузка/сохранение**:
  - ключа (hex)
  - открытого текста (UTF-8)
  - шифртекста-контейнера (UTF-8)
- Удобные кнопки копирования в буфер обмена
- Подсказки и проверки корректности входных данных

---
## 2. Структура проекта

```

serpent_tk_app/
├─ README.md
├─ requirements.txt
├─ main.py
└─ app/
├─ **init**.py
├─ gui.py
├─ serpent.py
└─ utils.py

````

- `app/serpent.py` — реализация Serpent (ядро, шифрование/расшифрование **только 16-байтных блоков**).
- `app/utils.py` — режим Serpent-CTR, контейнер шифртекста, валидация, генерация ключа, чтение/запись файлов.
- `app/gui.py` — интерфейс tkinter/ttk.
- `main.py` — точка входа (запуск GUI).

---
## 3. Требования

- Python **3.9.12**
- Дополнительные библиотеки не требуются (только стандартная библиотека).

---

## 4. Запуск

### Windows (PowerShell / CMD)
```bash
python --version
python main.py
````

Если в системе несколько Python, используйте `py -3.9`:

```bash
py -3.9 main.py
```

---
## 5. Формат ключа

Ключ вводится в формате **hex** (пробелы допускаются — они игнорируются).

Допустимые размеры:

* **128 бит** = 16 байт = **64 hex-символа**
* **192 бита** = 24 байта = **96 hex-символов**
* **256 бит** = 32 байта = **128 hex-символов**

Допускается префикс `0x`.

Примеры:

* 128 бит:

  ```
  0x00112233445566778899aabbccddeeff
  ```
* 256 бит (с пробелами для читаемости):

  ```
  00112233 44556677 8899aabb ccddeeff 00010203 04050607 08090a0b 0c0d0e0f
  ```

---
## 6. Формат шифртекста (контейнер)

После шифрования приложение выводит строку-контейнер:

```
v1:<nonce_base64>:<ciphertext_base64>
```

* `nonce_base64` — 8 байт nonce, закодированный в base64
* `ciphertext_base64` — шифртекст в base64
* `v1` — версия контейнера

Также при расшифровании допускается расширенный формат:

```
v1:serpent-ctr:<nonce_base64>:<ciphertext_base64>
```

---
## 7. Режим Serpent-CTR (как работает)

* Serpent — блочный шифр 128 бит (16 байт).
* CTR не требует padding, подходит для произвольной длины текста.
* Формирование блока счётчика:

  * `counter_block = nonce(8 байт) || counter(8 байт, big-endian)`
  * `counter` начинается с 0 и увеличивается на 1 для каждого 16-байтного блока.
* Keystream:

  * `keystream = Serpent.encrypt_block(counter_block)`
* Шифрование/расшифрование:

  * `output = input XOR keystream`

---
## 8. Работа с файлами

GUI поддерживает загрузку/сохранение **в UTF-8**:

* Ключ: `key_hex.txt`
* Открытый текст: `plaintext.txt`
* Контейнер шифртекста: `cipher_container.txt`

Ограничение на размер по умолчанию:

* текст: до **1 MB**
* контейнер/сохранение: до **2 MB** (можно изменить в `app/utils.py`)

---
## 9. Примеры тестовых файлов

Создайте несколько `.txt` файлов (UTF-8).

### `dataset_test_1.txt`

```text
Заявка № 2026-01-06
Подразделение: Учебный отдел
Содержание: Список студентов, успеваемость, контакты.
Комментарий: данные конфиденциальные, требуется шифрование при хранении и передаче.

ФИО: Иванов Иван Иванович
Телефон: +7 999 123-45-67
Email: ivanov@example.com
```

### `dataset_test_2.txt`

```text
Служебная записка

Прошу предоставить доступ к внутреннему порталу для сотрудника:
ФИО: Петров Пётр Петрович
Должность: специалист ИС
Основание: приказ № 17/ИС от 06.01.2026

Примечание: доступ должен быть выдан на срок 30 дней.
```

### `dataset_control.txt`

```text
Контрольный текст для проверки обратимости:
1) Русский текст + знаки препинания: «», —, …, №
2) English text: Hello, world!
3) Числа и символы: 1234567890 !@#$%^&*()_+-=
4) Многострочность:
   строка 1
   строка 2
   строка 3
```
